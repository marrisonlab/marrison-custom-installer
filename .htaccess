# Protezione cartella wp-updates

# Permetti accesso solo a index.php e file ZIP
<FilesMatch "\.(php|json)$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

<FilesMatch "\.zip$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# Blocca accesso a tutti gli altri file
<FilesMatch "^(?!index\.php$).*\.php$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Disabilita listing delle directory
Options -Indexes

# Opzionale: Limita accesso solo ai tuoi domini
# Decommentare per abilitare
# <Files "*.zip">
#     SetEnvIf Referer "^https://(www\.)?tuosito1\.com" allow
#     SetEnvIf Referer "^https://(www\.)?tuosito2\.com" allow
#     Order Deny,Allow
#     Deny from all
#     Allow from env=allow
# </Files>

# Headers di sicurezza
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
</IfModule>

# Impedisce l'indicizzazione della cartella e dei file contenuti
<IfModule mod_headers.c>
    Header set X-Robots-Tag "noindex, nofollow, noarchive, nosnippet"
</IfModule>